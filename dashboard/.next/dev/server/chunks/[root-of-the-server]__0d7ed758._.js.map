{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/namanlimani/Desktop/project_copy/dashboard/lib/mongodb.ts"],"sourcesContent":["// lib/mongodb.ts\nimport { MongoClient } from 'mongodb';\n\nif (!process.env.MONGODB_URI) {\n  throw new Error('Invalid/Missing environment variable: \"MONGODB_URI\"');\n}\n\nconst uri = process.env.MONGODB_URI;\nconst options = {};\n\nlet client;\nlet clientPromise: Promise<MongoClient>;\n\nif (process.env.NODE_ENV === 'development') {\n  let globalWithMongo = global as typeof globalThis & {\n    _mongoClientPromise?: Promise<MongoClient>;\n  };\n\n  if (!globalWithMongo._mongoClientPromise) {\n    client = new MongoClient(uri, options);\n    globalWithMongo._mongoClientPromise = client.connect();\n  }\n  clientPromise = globalWithMongo._mongoClientPromise;\n} else {\n  client = new MongoClient(uri, options);\n  clientPromise = client.connect();\n}\n\nexport default clientPromise;"],"names":[],"mappings":"AAAA,iBAAiB;;;;;AACjB;;AAEA,IAAI,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;IAC5B,MAAM,IAAI,MAAM;AAClB;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AACnC,MAAM,UAAU,CAAC;AAEjB,IAAI;AACJ,IAAI;AAEJ,wCAA4C;IAC1C,IAAI;IAIJ,IAAI,CAAC,gBAAgB,mBAAmB,EAAE;QACxC,SAAS,IAAI,sHAAW,CAAC,KAAK;QAC9B,gBAAgB,mBAAmB,GAAG,OAAO,OAAO;IACtD;IACA,gBAAgB,gBAAgB,mBAAmB;AACrD;;uCAKe"}},
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"sources":["file:///Users/namanlimani/Desktop/project_copy/dashboard/app/api/trends/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport clientPromise from '@/lib/mongodb';\n\n// Configuration\nconst WINDOW_MINUTES = 360;\n\nexport async function GET(request: Request) {\n  const { searchParams } = new URL(request.url);\n  const type = searchParams.get('type'); // 'hashtags' or 'entities'\n  \n  try {\n    const client = await clientPromise;\n    const db = client.db(\"bigdata\");\n\n    // 1. Common Setup (Run for BOTH types)\n    const thirtyMinsAgo = new Date(Date.now() - WINDOW_MINUTES * 60 * 1000).toISOString();\n    \n    // Determine target collection and field\n    const collectionName = type === 'entities' ? 'entities' : 'hashtags';\n    const arrayField = type === 'entities' ? '$entities' : '$hashtags';\n    \n    // 2. Build Pipeline\n    const pipeline: any[] = [\n      // Filter by Time\n      {\n        $match: {\n          created_at: { $gte: thirtyMinsAgo },\n        }\n      },\n      // Unwind the array\n      { $unwind: arrayField },\n    ];\n\n    // 3. Conditional Logic\n    if (type === 'entities') {\n      // Entities logic\n      pipeline.push({\n         $match: {\n            \"entities.label\": { $in: [\"PERSON\", \"ORG\", \"GPE\", \"EVENT\", \"PRODUCT\", \"WORK_OF_ART\"] }\n         }\n      });\n      pipeline.push({\n        $group: { _id: \"$entities.text\", count: { $sum: 1 } }\n      });\n    } else {\n      // Hashtags logic\n      pipeline.push({\n        $group: { _id: arrayField, count: { $sum: 1 } }\n      });\n    }\n\n    // 4. Sort & Limit (Common)\n    pipeline.push({ $sort: { count: -1 } });\n    pipeline.push({ $limit: 10 });\n\n    // 5. Execute & Return\n    const results = await db.collection(collectionName).aggregate(pipeline).toArray();\n\n    const leaderboard = results.map(r => ({\n      entity: r._id,\n      mentions: r.count\n    }));\n\n    return NextResponse.json(leaderboard);\n\n  } catch (e) {\n    console.error(\"Aggregation Error:\", e);\n    return NextResponse.json({ error: 'Failed to fetch trends' }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,gBAAgB;AAChB,MAAM,iBAAiB;AAEhB,eAAe,IAAI,OAAgB;IACxC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,OAAO,aAAa,GAAG,CAAC,SAAS,2BAA2B;IAElE,IAAI;QACF,MAAM,SAAS,MAAM,2HAAa;QAClC,MAAM,KAAK,OAAO,EAAE,CAAC;QAErB,uCAAuC;QACvC,MAAM,gBAAgB,IAAI,KAAK,KAAK,GAAG,KAAK,iBAAiB,KAAK,MAAM,WAAW;QAEnF,wCAAwC;QACxC,MAAM,iBAAiB,SAAS,aAAa,aAAa;QAC1D,MAAM,aAAa,SAAS,aAAa,cAAc;QAEvD,oBAAoB;QACpB,MAAM,WAAkB;YACtB,iBAAiB;YACjB;gBACE,QAAQ;oBACN,YAAY;wBAAE,MAAM;oBAAc;gBACpC;YACF;YACA,mBAAmB;YACnB;gBAAE,SAAS;YAAW;SACvB;QAED,uBAAuB;QACvB,IAAI,SAAS,YAAY;YACvB,iBAAiB;YACjB,SAAS,IAAI,CAAC;gBACX,QAAQ;oBACL,kBAAkB;wBAAE,KAAK;4BAAC;4BAAU;4BAAO;4BAAO;4BAAS;4BAAW;yBAAc;oBAAC;gBACxF;YACH;YACA,SAAS,IAAI,CAAC;gBACZ,QAAQ;oBAAE,KAAK;oBAAkB,OAAO;wBAAE,MAAM;oBAAE;gBAAE;YACtD;QACF,OAAO;YACL,iBAAiB;YACjB,SAAS,IAAI,CAAC;gBACZ,QAAQ;oBAAE,KAAK;oBAAY,OAAO;wBAAE,MAAM;oBAAE;gBAAE;YAChD;QACF;QAEA,2BAA2B;QAC3B,SAAS,IAAI,CAAC;YAAE,OAAO;gBAAE,OAAO,CAAC;YAAE;QAAE;QACrC,SAAS,IAAI,CAAC;YAAE,QAAQ;QAAG;QAE3B,sBAAsB;QACtB,MAAM,UAAU,MAAM,GAAG,UAAU,CAAC,gBAAgB,SAAS,CAAC,UAAU,OAAO;QAE/E,MAAM,cAAc,QAAQ,GAAG,CAAC,CAAA,IAAK,CAAC;gBACpC,QAAQ,EAAE,GAAG;gBACb,UAAU,EAAE,KAAK;YACnB,CAAC;QAED,OAAO,gJAAY,CAAC,IAAI,CAAC;IAE3B,EAAE,OAAO,GAAG;QACV,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAyB,GAAG;YAAE,QAAQ;QAAI;IAC9E;AACF"}}]
}